<div class="modal fade" id="app-modal-patient-alert" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">{{ 'app.patient_alert.label'|trans }}</h4>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>

<script>

    $('body').on('submit', 'form.app-patient-alert-form', function (e) {
        e.preventDefault();

        var form = $(this);
        ajaxFormHandler(form, function (data) {
            if (!data.error) {
                if ( typeof refreshAlertList === 'function' ) {
                    refreshAlertList();
                }
                if ( typeof refreshCalendarWidget === 'function' ) {
                    refreshCalendarWidget();
                }
            }
        });
    });

    {% if patient is defined or (entity is defined and entity.patient is defined) %}

    $('body').on('click', '.app-patient-alert-create', function (e) {
        e.preventDefault();
        loaderShow();

        var url = Routing.generate('patient_alert_create', {
            'id': '{{ app_hash(patient is defined ? patient : (entity.patient is defined ? entity.patient : entity)) }}'
        });

        $.get(url, {}, function (data) {
            data = $.parseJSON(data);
            if (typeof data.form !== 'undefined') {
                $('#app-modal-patient-alert .modal-body').html(data.form);
                $('#app-modal-patient-alert').modal('show');
                ajaxModalButtons($('#app-modal-patient-alert'));
            }
            loaderHide();
        });
    });

    {% endif %}

    $('body').on('click', '.app-patient-alert-edit', function (e) {
        e.preventDefault();
        loaderShow();

        var alertId = $(this).data('entityId');

        var url = Routing.generate('patient_alert_update', {
            'id': alertId
        });

        $.get(url, {}, function (data) {
            data = $.parseJSON(data);
            if (typeof data.form !== 'undefined') {
                $('#app-modal-patient-alert .modal-body').html(data.form);
                $('#app-modal-patient-alert').modal('show');
                ajaxModalButtons($('#app-modal-patient-alert'));
            }
            loaderHide();
        });
    });

    $('body').on('click', '.app-patient-alert-remove', function (e) {

        var alertId = $(this).data('entityId');
        var el = $(this);

        deleteConfirmationHandler(el, function () {
            loaderShow();

            var url = Routing.generate('patient_alert_delete', {
                'id': alertId
            });

            $.get(url, {}, function (data) {
                refreshAlertList();
                loaderHide();
                notify('app.patient_alert.message.deleted', 'success');
            });
        });
    });

    {% if patient is defined or (entity is defined and entity.patient is defined) %}

    function refreshAlertList() {
        loaderShow();

        var url = Routing.generate('patient_alert_list', {
            'id': '{{ app_hash(patient is defined ? patient : (entity.patient is defined ? entity.patient : entity)) }}'
        });

        $.get(url, {}, function (data) {
            $(".app-patient-alert-list").replaceWith(data);
            loaderHide();
        });
    }

    {% endif %}


</script>
