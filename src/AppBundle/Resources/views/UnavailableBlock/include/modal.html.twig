<script>

    $('body').on('submit', 'form.app-unavailable-block-form', function (e) {
        e.preventDefault();

        var form = $(this);
        ajaxFormHandler(form, function (data) {
            render();
            if (!data.error) {
                $("#calendar").fullCalendar('refetchEvents');
            }
        });
    });

    $('body').on('click', '.app-unavailable-block-create', function (e) {
        e.preventDefault();
        unavailableBlockCreate();
    });

    $('body').on('click', '.app-appointment-edit', function (e) {

    });

    $('body').on('click', '.app-unavailable-block-edit', function (e) {
        e.preventDefault();

        var unavailableBlockId = $(this).data('entityId');

        var parentModal = $(this).parents('.modal:first');
        if ($(parentModal).length) {
            $(parentModal).modal('hide');
            $(parentModal).on('hidden.bs.modal', function (e) {
                $(parentModal).off('hidden.bs.modal');
                eventEdit(unavailableBlockId);
            });
            return;
        }

        eventEdit(unavailableBlockId);
    });

    function unavailableBlockCreate(date) {
        eventCreate(date, 'unavailable_block_create', {}, '{{ 'app.unavailable_block.new'|trans }}');
    }

</script>
