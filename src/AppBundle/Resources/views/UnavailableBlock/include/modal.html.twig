<script>

    $('body').on('submit', 'form.app-unavailable-block-form', function (e) {
        e.preventDefault();

        var form = $(this);
        ajaxFormHandler(form, function (data) {
            render();
            if (!data.error) {
                redirectToCal();
                $("#calendar").fullCalendar('refetchEvents');
            }
        });
    });

    $('body').on('click', '.app-unavailable-block-create', function (e) {
        e.preventDefault();
        unavailableBlockCreate();
    });

    $('body').on('click', '.app-unavailable-block-edit', function (e) {
        e.preventDefault();

        var unavailableBlockId = $(this).data('entityId');

        var parentModal = $(this).parents('.modal:first');
        if ($(parentModal).length) {
            eventEdit(unavailableBlockId, parentModal);
            return;
        }

        eventEdit(unavailableBlockId);
    });

    function unavailableBlockCreate(date, resourceIndex) {
        var routeParams = {};
        routeParams.resourceId = resourceIndex;
        eventCreate(date, 'unavailable_block_create', routeParams, '{{ 'app.unavailable_block.new'|trans }}');
    }

</script>
